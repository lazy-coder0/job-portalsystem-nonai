<!DOCTYPE html>
<html>
<head>
  <title>Test Jobs Connection</title>
</head>
<body>
  <h1>Testing Supabase Jobs Connection</h1>
  <div id="result"></div>

  <script src="JS/config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    (async function() {
      const { SUPABASE_URL, SUPABASE_ANON_KEY } = window.APP_CONFIG;
      const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '<p>Loading jobs...</p>';
      
      try {
        console.log('Querying jobs...');
        const { data: jobs, error } = await supabase
          .from('jobs')
          .select('*')
          .order('created_at', { ascending: false });
        
        console.log('Result:', { jobs, error });
        
        if (error) {
          resultDiv.innerHTML = `<p style="color:red">ERROR: ${error.message}</p>
            <pre>${JSON.stringify(error, null, 2)}</pre>`;
        } else if (!jobs || jobs.length === 0) {
          resultDiv.innerHTML = '<p style="color:orange">No jobs found in database</p>';
        } else {
          resultDiv.innerHTML = `<p style="color:green">SUCCESS: Found ${jobs.length} jobs!</p>
            <pre>${JSON.stringify(jobs[0], null, 2)}</pre>`;
        }
      } catch (err) {
        resultDiv.innerHTML = `<p style="color:red">EXCEPTION: ${err.message}</p>`;
        console.error(err);
      }
    })();
  </script>
</body>
</html>
